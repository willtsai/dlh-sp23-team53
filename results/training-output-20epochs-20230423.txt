training for h task on mimic3 dataset:
486845
Epoch 1 / 20:
    Step 188 / 188, LR: 0.01, time cost: 4m14.7s, loss: 0.498181967
    Evaluation: loss: 0.4678 --- auc: 0.8587 --- f1_score: 0.7360
Epoch 2 / 20:
    Step 188 / 188, LR: 0.001, time cost: 4m14.9s, loss: 0.408181333
    Evaluation: loss: 0.4485 --- auc: 0.8599 --- f1_score: 0.7446
Epoch 3 / 20:
    Step 188 / 188, LR: 0.0001, time cost: 4m12.2s, loss: 0.388787001
    Evaluation: loss: 0.4497 --- auc: 0.8596 --- f1_score: 0.7466
Epoch 4 / 20:
    Step 188 / 188, LR: 1e-05, time cost: 4m9.6s, loss: 0.3866866779
    Evaluation: loss: 0.4499 --- auc: 0.8595 --- f1_score: 0.7466
Epoch 5 / 20:
    Step 188 / 188, LR: 1e-05, time cost: 4m8.5s, loss: 0.3863863362
    Evaluation: loss: 0.4500 --- auc: 0.8596 --- f1_score: 0.7466
Epoch 6 / 20:
    Step 188 / 188, LR: 1e-05, time cost: 4m5.5s, loss: 0.3860860097
    Evaluation: loss: 0.4501 --- auc: 0.8596 --- f1_score: 0.7466
Epoch 7 / 20:
    Step 188 / 188, LR: 1e-05, time cost: 4m5.1s, loss: 0.3858858869
    Evaluation: loss: 0.4502 --- auc: 0.8595 --- f1_score: 0.7466
Epoch 8 / 20:
    Step 188 / 188, LR: 1e-05, time cost: 4m7.6s, loss: 0.3855855448
    Evaluation: loss: 0.4502 --- auc: 0.8595 --- f1_score: 0.7486
Epoch 9 / 20:
    Step 188 / 188, LR: 1e-05, time cost: 4m6.8s, loss: 0.3852852623
    Evaluation: loss: 0.4504 --- auc: 0.8595 --- f1_score: 0.7486
Epoch 10 / 20:
    Step 188 / 188, LR: 1e-05, time cost: 4m6.5s, loss: 0.3850850069
    Evaluation: loss: 0.4504 --- auc: 0.8594 --- f1_score: 0.7507
Epoch 11 / 20:
    Step 188 / 188, LR: 1e-05, time cost: 4m5.8s, loss: 0.3847847598
    Evaluation: loss: 0.4505 --- auc: 0.8595 --- f1_score: 0.7473
Epoch 12 / 20:
    Step 188 / 188, LR: 1e-05, time cost: 4m5.6s, loss: 0.3844844052
    Evaluation: loss: 0.4506 --- auc: 0.8595 --- f1_score: 0.7403
Epoch 13 / 20:
    Step 188 / 188, LR: 1e-05, time cost: 4m5.9s, loss: 0.3842842592
    Evaluation: loss: 0.4507 --- auc: 0.8596 --- f1_score: 0.7403
Epoch 14 / 20:
    Step 188 / 188, LR: 1e-05, time cost: 4m6.1s, loss: 0.3839839494
    Evaluation: loss: 0.4507 --- auc: 0.8594 --- f1_score: 0.7403
Epoch 15 / 20:
    Step 188 / 188, LR: 1e-05, time cost: 4m6.7s, loss: 0.3836836227
    Evaluation: loss: 0.4508 --- auc: 0.8594 --- f1_score: 0.7403
Epoch 16 / 20:
    Step 188 / 188, LR: 1e-05, time cost: 4m6.5s, loss: 0.3833833105
    Evaluation: loss: 0.4509 --- auc: 0.8595 --- f1_score: 0.7368
Epoch 17 / 20:
    Step 188 / 188, LR: 1e-05, time cost: 4m5.7s, loss: 0.3831831176
    Evaluation: loss: 0.4510 --- auc: 0.8595 --- f1_score: 0.7368
Epoch 18 / 20:
    Step 188 / 188, LR: 1e-05, time cost: 4m5.9s, loss: 0.3828828123
    Evaluation: loss: 0.4511 --- auc: 0.8595 --- f1_score: 0.7368
Epoch 19 / 20:
    Step 188 / 188, LR: 1e-05, time cost: 4m6.8s, loss: 0.3825825174
    Evaluation: loss: 0.4511 --- auc: 0.8595 --- f1_score: 0.7368
Epoch 20 / 20:
    Step 188 / 188, LR: 1e-05, time cost: 4m6.5s, loss: 0.3822822351
    Evaluation: loss: 0.4512 --- auc: 0.8593 --- f1_score: 0.7368
Evaluating model on test data...
    Evaluation: loss: 0.4676 --- auc: 0.8448 --- f1_score: 0.7124
Test loss: 0.46755924212932587, F1 score: 0.7124463519313305, AUC or TopK: 0.844755521692903

****************************************************************************************************

training for h task on mimic4 dataset:
579405
Epoch 1 / 20:
    Step 250 / 250, LR: 0.01, time cost: 14m58.0s, loss: 0.26899710
    Evaluation: loss: 0.2777 --- auc: 0.9266 --- f1_score: 0.7299
Epoch 2 / 20:
    Step 250 / 250, LR: 0.001, time cost: 15m0.5s, loss: 0.204040104
    Evaluation: loss: 0.2413 --- auc: 0.9312 --- f1_score: 0.7650
Epoch 3 / 20:
    Step 250 / 250, LR: 0.0001, time cost: 15m15.4s, loss: 0.19322748
    Evaluation: loss: 0.2413 --- auc: 0.9311 --- f1_score: 0.7663
Epoch 4 / 20:
    Step 250 / 250, LR: 1e-05, time cost: 15m15.2s, loss: 0.19166492
    Evaluation: loss: 0.2413 --- auc: 0.9311 --- f1_score: 0.7663
Epoch 5 / 20:
    Step 250 / 250, LR: 1e-05, time cost: 15m14.3s, loss: 0.19144090
    Evaluation: loss: 0.2414 --- auc: 0.9311 --- f1_score: 0.7663
Epoch 6 / 20:
    Step 250 / 250, LR: 1e-05, time cost: 15m14.1s, loss: 0.19122673
    Evaluation: loss: 0.2414 --- auc: 0.9311 --- f1_score: 0.7663
Epoch 7 / 20:
    Step 250 / 250, LR: 1e-05, time cost: 15m14.4s, loss: 0.19111720
    Evaluation: loss: 0.2415 --- auc: 0.9311 --- f1_score: 0.7663
Epoch 8 / 20:
    Step 250 / 250, LR: 1e-05, time cost: 15m17.6s, loss: 0.19099844
    Evaluation: loss: 0.2416 --- auc: 0.9310 --- f1_score: 0.7663
Epoch 9 / 20:
    Step 250 / 250, LR: 1e-05, time cost: 15m17.0s, loss: 0.19077715
    Evaluation: loss: 0.2417 --- auc: 0.9310 --- f1_score: 0.7663
Epoch 10 / 20:
    Step 250 / 250, LR: 1e-05, time cost: 15m15.2s, loss: 0.19066118
    Evaluation: loss: 0.2418 --- auc: 0.9310 --- f1_score: 0.7663
Epoch 11 / 20:
    Step 250 / 250, LR: 1e-05, time cost: 15m17.1s, loss: 0.19044812
    Evaluation: loss: 0.2418 --- auc: 0.9310 --- f1_score: 0.7663
Epoch 12 / 20:
    Step 250 / 250, LR: 1e-05, time cost: 15m16.0s, loss: 0.19033885
    Evaluation: loss: 0.2419 --- auc: 0.9310 --- f1_score: 0.7663
Epoch 13 / 20:
    Step 250 / 250, LR: 1e-05, time cost: 15m17.9s, loss: 0.19011375
    Evaluation: loss: 0.2420 --- auc: 0.9309 --- f1_score: 0.7663
Epoch 14 / 20:
    Step 250 / 250, LR: 1e-05, time cost: 15m16.9s, loss: 0.18999430
    Evaluation: loss: 0.2421 --- auc: 0.9309 --- f1_score: 0.7663
Epoch 15 / 20:
    Step 250 / 250, LR: 1e-05, time cost: 15m18.4s, loss: 0.18988757
    Evaluation: loss: 0.2422 --- auc: 0.9309 --- f1_score: 0.7663
Epoch 16 / 20:
    Step 250 / 250, LR: 1e-05, time cost: 15m19.9s, loss: 0.18966027
    Evaluation: loss: 0.2423 --- auc: 0.9309 --- f1_score: 0.7663
Epoch 17 / 20:
    Step 250 / 250, LR: 1e-05, time cost: 15m19.9s, loss: 0.18955238
    Evaluation: loss: 0.2424 --- auc: 0.9308 --- f1_score: 0.7629
Epoch 18 / 20:
    Step 250 / 250, LR: 1e-05, time cost: 43m0.6s, loss: 0.189393752
    Evaluation: loss: 0.2425 --- auc: 0.9308 --- f1_score: 0.7629
Epoch 19 / 20:
    Step 250 / 250, LR: 1e-05, time cost: 2h1m36.9s, loss: 0.189228777
    Evaluation: loss: 0.2425 --- auc: 0.9308 --- f1_score: 0.7629
Epoch 20 / 20:
    Step 250 / 250, LR: 1e-05, time cost: 2h25m32.2s, loss: 0.189000154
    Evaluation: loss: 0.2426 --- auc: 0.9307 --- f1_score: 0.7629
Evaluating model on test data...
    Evaluation: loss: 0.2312 --- auc: 0.9340 --- f1_score: 0.7529
Test loss: 0.2312017776966095, F1 score: 0.7528735632183907, AUC or TopK: 0.9339847904167586

****************************************************************************************************

training for m task on mimic3 dataset:
1223574
Epoch 1 / 20:
    Step 188 / 188, LR: 0.01, time cost: 8m5.6s, loss: 1609.9511511158
    Evaluation: loss: 136.0098 --- f1_score: 0.1081 --- top_k_recall: 0.1709, 0.2634, 0.3205, 0.3688  --- occurred: 0.0965, 0.1275, 0.1450, 0.1583  --- not occurred: 0.0744, 0.1360, 0.1754, 0.2104
Epoch 2 / 20:
    Step 188 / 188, LR: 0.01, time cost: 6m51.1s, loss: 1559.561212231
    Evaluation: loss: 140.7598 --- f1_score: 0.1186 --- top_k_recall: 0.2014, 0.2842, 0.3525, 0.3918  --- occurred: 0.1029, 0.1291, 0.1538, 0.1727  --- not occurred: 0.0985, 0.1551, 0.1987, 0.2191
Epoch 3 / 20:
    Step 188 / 188, LR: 0.01, time cost: 45m3.5s, loss: 1558.4279796684
    Evaluation: loss: 131.7789 --- f1_score: 0.1284 --- top_k_recall: 0.2064, 0.2883, 0.3499, 0.3956  --- occurred: 0.1085, 0.1330, 0.1556, 0.1694  --- not occurred: 0.0978, 0.1553, 0.1943, 0.2263
Epoch 4 / 20:
    Step 188 / 188, LR: 0.01, time cost: 49m1.8s, loss: 1558.59414189182
    Evaluation: loss: 130.0533 --- f1_score: 0.1394 --- top_k_recall: 0.2202, 0.2998, 0.3650, 0.4098  --- occurred: 0.1115, 0.1403, 0.1637, 0.1782  --- not occurred: 0.1088, 0.1595, 0.2013, 0.2316
Epoch 5 / 20:
    Step 188 / 188, LR: 0.01, time cost: 53m12.1s, loss: 1557.958442716
    Evaluation: loss: 123.2420 --- f1_score: 0.1432 --- top_k_recall: 0.2225, 0.3098, 0.3746, 0.4270  --- occurred: 0.1179, 0.1533, 0.1739, 0.1902  --- not occurred: 0.1046, 0.1564, 0.2007, 0.2368
Epoch 6 / 20:
    Step 188 / 188, LR: 0.01, time cost: 56m29.0s, loss: 1556.8983322395
    Evaluation: loss: 127.2800 --- f1_score: 0.1583 --- top_k_recall: 0.2247, 0.3295, 0.3935, 0.4389  --- occurred: 0.1163, 0.1580, 0.1829, 0.1983  --- not occurred: 0.1084, 0.1715, 0.2106, 0.2406
Epoch 7 / 20:
    Step 188 / 188, LR: 0.01, time cost: 51m35.6s, loss: 1556.1850096915
    Evaluation: loss: 110.6640 --- f1_score: 0.1646 --- top_k_recall: 0.2338, 0.3260, 0.3853, 0.4346  --- occurred: 0.1261, 0.1619, 0.1836, 0.1963  --- not occurred: 0.1077, 0.1641, 0.2017, 0.2383
Epoch 8 / 20:
    Step 188 / 188, LR: 0.01, time cost: 1h7m59.0s, loss: 1556.21020899
    Evaluation: loss: 120.8498 --- f1_score: 0.1723 --- top_k_recall: 0.2343, 0.3271, 0.3926, 0.4376  --- occurred: 0.1329, 0.1691, 0.1880, 0.2022  --- not occurred: 0.1014, 0.1580, 0.2046, 0.2354
Epoch 9 / 20:
    Step 188 / 188, LR: 0.01, time cost: 1h18m16.7s, loss: 1554.97612456
    Evaluation: loss: 121.5457 --- f1_score: 0.1732 --- top_k_recall: 0.2420, 0.3361, 0.4019, 0.4483  --- occurred: 0.1371, 0.1720, 0.1915, 0.2038  --- not occurred: 0.1049, 0.1641, 0.2104, 0.2445
Epoch 10 / 20:
    Step 188 / 188, LR: 0.01, time cost: 59m20.1s, loss: 1554.7189914604
    Evaluation: loss: 111.6923 --- f1_score: 0.1792 --- top_k_recall: 0.2467, 0.3367, 0.4038, 0.4503  --- occurred: 0.1402, 0.1740, 0.1954, 0.2083  --- not occurred: 0.1065, 0.1627, 0.2084, 0.2420
Epoch 11 / 20:
    Step 188 / 188, LR: 0.01, time cost: 1h25m28.4s, loss: 1554.24259966
    Evaluation: loss: 108.3710 --- f1_score: 0.1882 --- top_k_recall: 0.2492, 0.3426, 0.4080, 0.4531  --- occurred: 0.1437, 0.1782, 0.1981, 0.2092  --- not occurred: 0.1055, 0.1644, 0.2098, 0.2439
Epoch 12 / 20:
    Step 188 / 188, LR: 0.01, time cost: 33m52.5s, loss: 1553.702223036
    Evaluation: loss: 101.8001 --- f1_score: 0.1939 --- top_k_recall: 0.2574, 0.3520, 0.4126, 0.4608  --- occurred: 0.1428, 0.1809, 0.2003, 0.2140  --- not occurred: 0.1146, 0.1711, 0.2123, 0.2468
Epoch 13 / 20:
    Step 188 / 188, LR: 0.01, time cost: 32m0.4s, loss: 1553.0004040003
    Evaluation: loss: 112.6662 --- f1_score: 0.1973 --- top_k_recall: 0.2558, 0.3473, 0.4069, 0.4555  --- occurred: 0.1465, 0.1810, 0.2024, 0.2172  --- not occurred: 0.1093, 0.1663, 0.2045, 0.2384
Epoch 14 / 20:
    Step 188 / 188, LR: 0.01, time cost: 4m9.0s, loss: 1552.6827827977
    Evaluation: loss: 99.5372 --- f1_score: 0.2007 --- top_k_recall: 0.2582, 0.3488, 0.4157, 0.4639  --- occurred: 0.1506, 0.1853, 0.2086, 0.2233  --- not occurred: 0.1076, 0.1635, 0.2071, 0.2406
Epoch 15 / 20:
    Step 188 / 188, LR: 0.001, time cost: 4m11.5s, loss: 1550.593636658
    Evaluation: loss: 99.0152 --- f1_score: 0.2095 --- top_k_recall: 0.2689, 0.3646, 0.4272, 0.4764  --- occurred: 0.1561, 0.1927, 0.2139, 0.2258  --- not occurred: 0.1128, 0.1719, 0.2134, 0.2507
Epoch 16 / 20:
    Step 188 / 188, LR: 0.001, time cost: 4m10.5s, loss: 1550.160404897
    Evaluation: loss: 99.7823 --- f1_score: 0.2131 --- top_k_recall: 0.2669, 0.3617, 0.4266, 0.4726  --- occurred: 0.1573, 0.1961, 0.2147, 0.2273  --- not occurred: 0.1096, 0.1656, 0.2118, 0.2452
Epoch 17 / 20:
    Step 188 / 188, LR: 1e-05, time cost: 4m12.2s, loss: 1549.714444891
    Evaluation: loss: 99.7574 --- f1_score: 0.2132 --- top_k_recall: 0.2666, 0.3619, 0.4265, 0.4725  --- occurred: 0.1571, 0.1960, 0.2146, 0.2272  --- not occurred: 0.1095, 0.1659, 0.2119, 0.2453
Epoch 18 / 20:
    Step 188 / 188, LR: 1e-05, time cost: 4m13.0s, loss: 1549.616161958
    Evaluation: loss: 99.6831 --- f1_score: 0.2132 --- top_k_recall: 0.2666, 0.3620, 0.4268, 0.4730  --- occurred: 0.1573, 0.1959, 0.2148, 0.2271  --- not occurred: 0.1093, 0.1662, 0.2120, 0.2459
Epoch 19 / 20:
    Step 188 / 188, LR: 1e-05, time cost: 4m12.5s, loss: 1549.309191042
    Evaluation: loss: 99.5622 --- f1_score: 0.2130 --- top_k_recall: 0.2665, 0.3621, 0.4271, 0.4723  --- occurred: 0.1573, 0.1958, 0.2150, 0.2271  --- not occurred: 0.1093, 0.1664, 0.2121, 0.2451
Epoch 20 / 20:
    Step 188 / 188, LR: 1e-05, time cost: 4m12.1s, loss: 1549.919393500
    Evaluation: loss: 99.5924 --- f1_score: 0.2132 --- top_k_recall: 0.2667, 0.3621, 0.4272, 0.4727  --- occurred: 0.1574, 0.1958, 0.2151, 0.2272  --- not occurred: 0.1093, 0.1664, 0.2120, 0.2456
Evaluating model on test data...
    Evaluation: loss: 98.6097 --- f1_score: 0.2124 --- top_k_recall: 0.2579, 0.3503, 0.4139, 0.4597  --- occurred: 0.1591, 0.1920, 0.2118, 0.2240  --- not occurred: 0.0989, 0.1583, 0.2021, 0.2356
Test loss: 98.60973766684532, F1 score: 0.21236173706720454, AUC or TopK: [0.25794787771677297, 0.3502976917188601, 0.4139315274235037, 0.4596504614437993]

****************************************************************************************************

training for m task on mimic4 dataset:
1490841
Epoch 1 / 20:
    Step 250 / 250, LR: 0.01, time cost: 15m13.1s, loss: 1960.84588843
    Evaluation: loss: 140.3669 --- f1_score: 0.1106 --- top_k_recall: 0.1856, 0.2644, 0.3155, 0.3555  --- occurred: 0.1153, 0.1506, 0.1726, 0.1899  --- not occurred: 0.0703, 0.1138, 0.1429, 0.1656
Epoch 2 / 20:
    Step 250 / 250, LR: 0.01, time cost: 15m17.7s, loss: 1919.32688277
    Evaluation: loss: 127.7122 --- f1_score: 0.1234 --- top_k_recall: 0.1942, 0.2789, 0.3359, 0.3691  --- occurred: 0.1185, 0.1609, 0.1844, 0.1961  --- not occurred: 0.0756, 0.1180, 0.1515, 0.1731
Epoch 3 / 20:
    Step 250 / 250, LR: 0.01, time cost: 14m56.2s, loss: 1918.80844468
    Evaluation: loss: 130.5509 --- f1_score: 0.1408 --- top_k_recall: 0.2129, 0.2899, 0.3443, 0.3894  --- occurred: 0.1328, 0.1686, 0.1912, 0.2086  --- not occurred: 0.0802, 0.1214, 0.1532, 0.1808
Epoch 4 / 20:
    Step 250 / 250, LR: 0.01, time cost: 14m59.4s, loss: 1917.87666836
    Evaluation: loss: 127.9827 --- f1_score: 0.1600 --- top_k_recall: 0.2322, 0.3170, 0.3653, 0.4034  --- occurred: 0.1469, 0.1848, 0.2025, 0.2160  --- not occurred: 0.0853, 0.1322, 0.1628, 0.1874
Epoch 5 / 20:
    Step 250 / 250, LR: 0.01, time cost: 14m58.1s, loss: 1916.62944972
    Evaluation: loss: 132.3880 --- f1_score: 0.1677 --- top_k_recall: 0.2355, 0.3200, 0.3753, 0.4179  --- occurred: 0.1495, 0.1858, 0.2083, 0.2217  --- not occurred: 0.0860, 0.1342, 0.1670, 0.1962
Epoch 6 / 20:
    Step 250 / 250, LR: 0.01, time cost: 15m10.2s, loss: 1916.02844609
    Evaluation: loss: 124.2000 --- f1_score: 0.1792 --- top_k_recall: 0.2438, 0.3298, 0.3838, 0.4242  --- occurred: 0.1601, 0.1981, 0.2187, 0.2308  --- not occurred: 0.0837, 0.1317, 0.1651, 0.1934
Epoch 7 / 20:
    Step 250 / 250, LR: 0.01, time cost: 14m59.7s, loss: 1915.39677388
    Evaluation: loss: 111.2638 --- f1_score: 0.1852 --- top_k_recall: 0.2545, 0.3414, 0.3945, 0.4361  --- occurred: 0.1612, 0.2029, 0.2242, 0.2384  --- not occurred: 0.0933, 0.1385, 0.1703, 0.1977
Epoch 8 / 20:
    Step 250 / 250, LR: 0.01, time cost: 15m0.7s, loss: 1914.769393960
    Evaluation: loss: 117.0480 --- f1_score: 0.2016 --- top_k_recall: 0.2623, 0.3469, 0.4029, 0.4469  --- occurred: 0.1709, 0.2078, 0.2306, 0.2447  --- not occurred: 0.0914, 0.1391, 0.1723, 0.2022
Epoch 9 / 20:
    Step 250 / 250, LR: 0.01, time cost: 14m47.0s, loss: 1914.01855219
    Evaluation: loss: 130.7677 --- f1_score: 0.2086 --- top_k_recall: 0.2631, 0.3515, 0.4023, 0.4413  --- occurred: 0.1754, 0.2165, 0.2338, 0.2451  --- not occurred: 0.0877, 0.1350, 0.1685, 0.1962
Epoch 10 / 20:
    Step 250 / 250, LR: 0.01, time cost: 14m47.6s, loss: 1913.33233724
    Evaluation: loss: 113.9702 --- f1_score: 0.2145 --- top_k_recall: 0.2731, 0.3564, 0.4085, 0.4470  --- occurred: 0.1836, 0.2192, 0.2373, 0.2487  --- not occurred: 0.0895, 0.1372, 0.1712, 0.1982
Epoch 11 / 20:
    Step 250 / 250, LR: 0.01, time cost: 14m46.7s, loss: 1912.05155459
    Evaluation: loss: 102.7103 --- f1_score: 0.2229 --- top_k_recall: 0.2755, 0.3592, 0.4115, 0.4506  --- occurred: 0.1836, 0.2202, 0.2388, 0.2492  --- not occurred: 0.0919, 0.1390, 0.1726, 0.2014
Epoch 12 / 20:
    Step 250 / 250, LR: 0.01, time cost: 14m51.3s, loss: 1911.75633426
    Evaluation: loss: 98.2009 --- f1_score: 0.2238 --- top_k_recall: 0.2788, 0.3641, 0.4170, 0.4550  --- occurred: 0.1850, 0.2220, 0.2428, 0.2543  --- not occurred: 0.0939, 0.1421, 0.1742, 0.2007
Epoch 13 / 20:
    Step 250 / 250, LR: 0.01, time cost: 14m46.8s, loss: 1911.34133307
    Evaluation: loss: 98.0284 --- f1_score: 0.2274 --- top_k_recall: 0.2779, 0.3650, 0.4153, 0.4564  --- occurred: 0.1893, 0.2229, 0.2423, 0.2545  --- not occurred: 0.0887, 0.1422, 0.1730, 0.2019
Epoch 14 / 20:
    Step 250 / 250, LR: 0.01, time cost: 14m51.6s, loss: 1910.51099143
    Evaluation: loss: 94.0349 --- f1_score: 0.2306 --- top_k_recall: 0.2825, 0.3669, 0.4192, 0.4577  --- occurred: 0.1950, 0.2275, 0.2447, 0.2554  --- not occurred: 0.0875, 0.1395, 0.1745, 0.2023
Epoch 15 / 20:
    Step 250 / 250, LR: 0.001, time cost: 14m59.1s, loss: 1908.28322406
    Evaluation: loss: 91.7083 --- f1_score: 0.2418 --- top_k_recall: 0.2893, 0.3742, 0.4296, 0.4727  --- occurred: 0.1986, 0.2324, 0.2511, 0.2642  --- not occurred: 0.0907, 0.1418, 0.1785, 0.2085
Epoch 16 / 20:
    Step 250 / 250, LR: 0.001, time cost: 14m56.8s, loss: 1907.77822241
    Evaluation: loss: 92.0589 --- f1_score: 0.2436 --- top_k_recall: 0.2899, 0.3726, 0.4292, 0.4713  --- occurred: 0.1995, 0.2324, 0.2529, 0.2646  --- not occurred: 0.0905, 0.1401, 0.1763, 0.2067
Epoch 17 / 20:
    Step 250 / 250, LR: 1e-05, time cost: 14m56.1s, loss: 1907.00255090
    Evaluation: loss: 91.8369 --- f1_score: 0.2435 --- top_k_recall: 0.2901, 0.3726, 0.4291, 0.4713  --- occurred: 0.1996, 0.2326, 0.2526, 0.2646  --- not occurred: 0.0905, 0.1401, 0.1765, 0.2066
Epoch 18 / 20:
    Step 250 / 250, LR: 1e-05, time cost: 14m56.1s, loss: 1907.42433190
    Evaluation: loss: 91.7160 --- f1_score: 0.2436 --- top_k_recall: 0.2899, 0.3732, 0.4294, 0.4712  --- occurred: 0.1994, 0.2328, 0.2529, 0.2645  --- not occurred: 0.0905, 0.1404, 0.1766, 0.2068
Epoch 19 / 20:
    Step 250 / 250, LR: 1e-05, time cost: 14m56.0s, loss: 1907.84611807
    Evaluation: loss: 91.5996 --- f1_score: 0.2439 --- top_k_recall: 0.2903, 0.3732, 0.4295, 0.4710  --- occurred: 0.1996, 0.2327, 0.2529, 0.2643  --- not occurred: 0.0907, 0.1405, 0.1766, 0.2067
Epoch 20 / 20:
    Step 250 / 250, LR: 1e-05, time cost: 14m53.3s, loss: 1906.96477381
    Evaluation: loss: 91.4745 --- f1_score: 0.2443 --- top_k_recall: 0.2904, 0.3730, 0.4297, 0.4711  --- occurred: 0.1995, 0.2326, 0.2528, 0.2643  --- not occurred: 0.0909, 0.1404, 0.1769, 0.2068
Evaluating model on test data...
    Evaluation: loss: 92.6286 --- f1_score: 0.2490 --- top_k_recall: 0.2911, 0.3749, 0.4264, 0.4659  --- occurred: 0.1959, 0.2305, 0.2459, 0.2566  --- not occurred: 0.0952, 0.1443, 0.1805, 0.2093
Test loss: 92.62864456953108, F1 score: 0.24902274296736865, AUC or TopK: [0.2911253708998661, 0.3748921348536283, 0.42643759203602294, 0.465917226972436]

****************************************************************************************************

{
    'mimic3-h': {
        'test_loss': 0.46755924212932587, 
        'f1_score': 0.7124463519313305, 
        'auc_or_topk': 0.844755521692903
        }, 
    'mimic4-h': {
        'test_loss': 0.2312017776966095, 
        'f1_score': 0.7528735632183907, 
        'auc_or_topk': 0.9339847904167586
        }, 
    'mimic3-m': {
        'test_loss': 98.60973766684532, 
        'f1_score': 0.21236173706720454, 
        'auc_or_topk': [ 
                0.25794787771677297,
                0.3502976917188601,
                0.4139315274235037,
                0.4596504614437993
            ]
        }, 
    'mimic4-m': {
        'test_loss': 92.62864456953108, 
        'f1_score': 0.24902274296736865, 
        'auc_or_topk': [
                0.2911253708998661,
                0.3748921348536283,
                0.42643759203602294,
                0.465917226972436
            ]
        }
}